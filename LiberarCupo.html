<!DOCTYPE html>
<html>
<head>
  <title>ACT Truck</title>

<meta charset=”UTF-8″ />

<link rel="shortcut icon" href="images/act-seal-logo1.png" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- <link rel="stylesheet" type="text/css" href="css/searcher.css"> -->

<link rel="stylesheet" type="text/css" href="css/stylosmobile.css">
  <script src="Scripts/jquery.min.js"></script>
   <script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
 <!-- <script type="text/javascript" charset="utf-8" src="phonegap-1.0.0.js"></script>-->

<head>
<body>
  <script type="text/javascript">




      function bodyonload() {
            document.addEventListener("deviceready", onDeviceReady, false);
		    //Muestra contenido de la pagina (efecto).
		    showin("logodiv");
		    showin("resumen");
		    showin("mainStatusLine");
		    showin("searchfilter");

			//Aca se verifica si ya se tiene asociado un cupo o se permite al usuario asociar su patente.
			var patente = localStorage.getItem("PATENTE");
			var dsPuerto = localStorage.getItem("PUERTO");
			var fechaCupoAux = localStorage.getItem("FECHACUPO");
			var nroCupo = localStorage.getItem("CODIGO");
			var dsEstado = "";


			fechaCupo = fechaCupoAux.trim().substring(0, 4) + '-' + fechaCupoAux.trim().substring(4, 6) + '-' + fechaCupoAux.trim().substring(6, 8);
			 
              switch(dsPuerto) {
                                 case "10"  :
                                    dsPuerto ='Transito';
                                    break;
                                 case "36":
                                    dsPuerto ='Arroyo';
                                    break;
                                 case "91":
                                    dsPuerto ='Bahia';
                                    break;
                                 default:
                                     dsPuerto = 'Error';
                             }

                             var OldPattern = /^[a-z]{3}[0-9]{3}$/;
                             var NewPattern = /^[a-z]{2}[0-9]{3}[a-z]{2}$/;
                             if (OldPattern.test(patente.toString().trim())) {
                                 patente = patente.trim().substring(0, 3) + '-' + patente.trim().substring(3, 6);
                             }

                            
                             if (NewPattern.test(patente.toString().trim())) {
                                 patente = patente.trim().substring(0, 2) + '-' + patente.trim().substring(2, 5) + '-' + patente.trim().substring(5, 7);
                             }


				//Tiene asociado un cupo				
				document.getElementById("nroCupo").innerHTML=nroCupo;
				document.getElementById("fechaCupo").innerHTML=fechaCupo;
				document.getElementById("puerto").innerHTML=dsPuerto;
				document.getElementById("patente").innerHTML=patente;
				document.getElementById("txtCupo").value="";
				document.getElementById("txtPatente").value="";

}

function LiberarCupo() {
    localStorage.clear();
    window.setTimeout(function () { window.location = "Registrarcupo.html"; }, 3000);
}
/*javascript css*/
function showin(ref) {
    document.getElementById(ref).style.opacity = '1';
}
/* END javascript css*/

function onDeviceReady() {
    // Añade una función 'callback' al evento 'backbutton'
    document.addEventListener("backbutton", onBackKeyDown, false);
}
function onBackKeyDown() {
    alert("onBackKeyDown");
    alert($.mobile.activePage.attr('id'));
    navigator.app.exitApp();

}


	</script>
</head>
<body onload="bodyonload()" >
	<div id="logodiv" class="logo-center">
		<img width="121" height="23" src="images/act-logo-small.png" alt="Toepfer">
	</div>	
	<hr id="mainStatusLine" class="fade" />	
	<div id="resumen" class="resumen-center fade ">  			
		<form name="frmSel" id="searchfilter" method="post" autocomplete="off">
			<ul>
				<li class="li-titulo">N&uacute;mero de Cupo</li>
				<li class="li-valor"><div id="nroCupo"></div></li>
				<li class="li-titulo">Fecha Cupo</li>
				<li class="li-valor"><div id="fechaCupo"></div></li>
				<li class="li-titulo">Planta</li>
				<li class="li-valor"><div id="puerto"></div></li>
				<li class="li-titulo">Patente</li>				
				<li class="li-valor"><div id="patente"></div></li>
				
			</ul>
			<button  id="searchfilter" type="button" class="input-cupo" onclick="LiberarCupo(txtCupo.value)" value="LIBERAR CUPO">LIBERAR CUPO </button>
			<input id="txtCupo" type="hidden" name="txtCupo"  />							
			<input id="txtPatente" type="hidden" name="txtPatente"  />					
		</form>
	</div>
	   </body>
<html>
